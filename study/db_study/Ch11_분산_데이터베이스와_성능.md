# 공부한 내용


## 1. 분산 데이터베이스의 개요

분산 데이터베이스란, 물리적으로는 분리되어 있지만 논리적으로는 동일한 시스템으로 인식되는 데이터베이스를 뜻한다. 물리적으로 분리되어있다는 뜻은, DB가 실재하는 위치가 다르다는 뜻이다.

## 2. 분산 데이터베이스의 투명성

여러가지 투명성에 관한 항목들이 있지만, 요약하자면 다음과 같다.

- 데이터가 여러 개로 나뉘어져 있든, 각기 다른 지역에 위치해있든 간에 이에 대한 관리를 DB 측에서 모두 해주기 때문에 사용자는 그 내부 구조에 대해 알 필요가 없다.
- 시스템의 오류가 발생해도 자동으로 처리되고 복구되기 때문에 사용자에게 문제가 되지 않는다.
- 여러 사용자가 동시에 DB에 접근하더라도 동시성에 대한 처리를 자동으로 해준다.

## 3. 분산 데이터베이스 활용

분산 데이터베이스는 업무 구조에 따라 선택적으로 적용하면 된다. → 너무 단조로운 설명이라 추가 조사가 필요할 듯 하다.

아래는 분산 데이터베이스의 장단점이다.

!https://dataonair.or.kr/publishing/img/knowledge/SQL_129.jpg

전체적으로 요약하자면, 장점으로는 용량 확장에 굉장히 용이하고 유연하며, 빠른 성능을 자랑한다는 점이 있다.

하지만 단점으로는, 분산 처리를 위한 소프트웨어 개발 비용이 추가적으로 들며, 설계나 관리하는데 상당히 복잡하고, 아무래도 통합 데이터베이스보다 오류 발생 가능성이 더 높다는 점이 존재한다.

## 4. 분산 데이터베이스를 쓰면 뭐가 좋을까?

가장 큰 장점은 성능이다. 원래 통합 데이터베이스를 사용하면 원거리에서 접속하거나, 다른 서버를 거치면서 생기는 성능 저하가 생기는데, 분산 환경에서는 이러한 저하가 없다.

## 5. 분산 데이터베이스의 종류

### 테이블 위치 분산

테이블의 구조는 똑같지만, 각 테이블의 위치가 다르다.

!https://dataonair.or.kr/publishing/img/knowledge/SQL_132.jpg

### 테이블 분할 분산

하나의 테이블을 수평, 또는 수직으로 분할하는 방법이다.

!https://dataonair.or.kr/publishing/img/knowledge/SQL_134.jpg

만약 칼럼들이 다 같이 쓰이는 통합 프로세스가 많다면, 칼럼들을 분리시키면 안되므로 수평분할을 하고, 통합 프로세스가 없다면 수직분할해도 된다.

다만, 수직분할 시에는 동일한 PK 구조를 가지도록 분할해야 한다.

### 테이블 복제 분산

동일한 테이블을 다른 지역에 부분적으로 복제, 또는 전체 복제해서 위치시키는 방법이다.

- 부분 복제
  - 각 지사에서 필요한 데이터만 부분적으로 사용할 수 있어서 효율성이 좋다.
  - 지사 간에는 데이터 중복이 발생하지 않고, 본사와 지사 간의 데이터 중복이 발생하게 된다.
  - 보통 지사에서 먼저 데이터를 입력/수정/삭제되고, 이를 본사가 복제, 이용하는 방식이다.

- 광역 복제
  - 본사와 지사가 모두 완벽히 동일한 데이터를 가진다.
  - 보통 본사에서 데이터가 입력/수정/삭제되고 지사가 이를 복제, 이용한다.

DB를 복제하는 것은 시간도 오래 걸리고 서버에 많은 부하가 발생하므로 보통 실시간 처리보다는 배치를 이용한 처리를 선택한다.

### 테이블 요약 분산

- 분석 요약
  - 각 지사별로 동일한 데이터에 대해 요약이 되어 있고, 이를 본사에서 통합해 정보를 산출하는 방식이다.
- 통합 요약
  - 각 지사별로 다른 데이터를 요약하고 있고, 이를 본사에서 취합하여 비교한다.

둘을 비교하자면, 분석 요약은 특정 목적에 맞는 데이터들을 모으는 느낌이고, 통합 요약은 여러 지역이나 조직의 전반적인 데이터들을 모으는 느낌이다.

## 6. 분산 데이터베이스를 적용하면 좋은 경우

- 성능이 중요한 서비스일 경우 분산 데이터베이스를 사용하면 성능이 향상된다.
- 비즈니스적으로 핵심적이고, 활용이 많이 되는 데이터들에 대해 분산 환경을 구성하면 성능이 향상된다.
- 실시간 환경이 아닐 때 사용하기 좋다.
- 특정 서버에 부하가 집중될 때 사용하기 좋다.

# 어려웠던 내용


## 데이터베이스 분할 중 테이블 요약 분산

테이블의 분할 분산, 복제 분산까지는 수월하게 이해했는데, 테이블 요약 분산에 대해서는 뭔가 이해가 애매하게 된 것 같다.

데이터를 요약해서 저장한다는 것이, 정확히 어떤 식으로 요약하는 것인지에 대해 알아보면 좋을 것 같다.

# 궁금한 내용 / 조사한 내용


## 분산 데이터베이스와 DB 클러스터링

뭔가 체감상 둘 다 데이터를 복제해서 여분의 목숨을 남겨놓는 느낌인 것 같아서 어떤 점이 다른지 조사해보게 되었다.

일단 둘 다 **“중단, 에러 없이 안정적으로 돌아가는 서비스”**를 위한 방법이란 점에서 공통점이 있다. 분산 데이터베이스와 DB 클러스터링 모두 원본 DB와 완전히 동일한 데이터를 복제하여 사용한다.

솔직히 조사를 많이 해봤는데 뭔가 뚜렷한 차이점이 있는 것 같지는 않고, 그냥 분산 데이터베이스는 보다 더 지리적 분산성에 초점이 맞춰져있는 것 같다. 즉, 동일한 데이터를 가진 DB 저장소가 물리적으로 떨어져있다는 것에 의미가 깊은 것 같다.

DB 클러스터링의 경우, 지리적 분산성이라는 특징이 없는 것은 아니지만 그것보다도 데이터의 복제와 고가용성(24시간 사용 가능한지)에 더 초점을 맞춘다고 볼 수 있다.

따라서 일반적으로는 물리적으로 데이터 센터가 떨어져있냐, 아니면 붙어있냐를 기준으로 구분하는 게 맞는 것 같다. 하지만 현업을 안 가봐서 이런 구분이 솔직히 의미가 있는지는 모르겠다 ㅋㅋ

## 용어 정리

- 테이블 복제 분산 → DB 클러스터링과 비슷한 개념이다. 데이터를 완전히 동일하게 복제한다.
- 테이블 분할 분산 → 샤딩, 테이블 파티셔닝과 비슷한 개념이다.

# 느낀점


뭔가 DB 클러스터링과 관련해서 많은 지식을 얻게된 것 같다.

데이터베이스 분산 환경을 구성하는 이유는 크게 정리하면 다음과 같다.

- 고가용성 → 24시간 서비스를 최대한 유지한다.
- 병렬처리 → 사용자 요청이 너무 많을 때, 병렬처리를 통해 서버 부하를 줄인다. (Load Balancing)
- 성능향상 → 원래대로면 먼 곳에서 가져와야 할 데이터인데, 복제된 DB 서버를 각지에 둠으로써 접근 시간이 줄어들고 성능이 향상된다.

계속해서 뭔가 DB 최적화에 관한 내용을 보다보니 앞에 3요소들이 확실히 무슨 말인지 알겠고, 의도도 이해가 되는 것 같다.

항상 느끼는 거지만, 서버 측에서 개발할 때 가장 중요하게 여기는 것은 일단은 에러나 중단 없이 안전하게 서비스가 돌아가는 것이고, 거기에 더해서 빠른 성능, 확장성 등의 요소가 추가되는 것 같다.

배우는 내용들이 다소 복잡한 부분도 있는데, 근본적으로 위와 같은 목적을 가졌다고 생각하면 그래도 이해가 쉽게 되는 것 같다.