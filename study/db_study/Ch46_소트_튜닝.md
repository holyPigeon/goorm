# 공부한 내용

## 1. 소트와 성능

### 메모리 소트와 디스크 소트

SQL 수행 도중에 소트가 필요한 경우에는 DBMS가 정해진 메모리 공간에 소트 영역을 할당하고 소트를 한다. 하지만 메모리 공간이 부족하다면, 디스크 영역을 할당한다.

당연한 얘기지만 메모리 영역에서 소트를 진행하는 것이 가장 속도가 빠른데, 대량의 데이터를 정렬할 땐 디스크 소트가 불가피하다.

(만약 전체 대상 집합을 디스크에 기록해야 하는 일이 생긴다? → 성능이 매우 나빠진다.)

![](https://prod-files-secure.s3.us-west-2.amazonaws.com/5486ac02-837a-4340-b853-a8cd7b03f65f/a511bee9-8fd3-40e2-a4a3-c0420bfbdc37/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-30_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.07.10.png)

### 소트를 발생시키는 오퍼레이션

소트는 언제 발생하는지 알아보자.

1. Sort Aggregate: 전체 로우를 대상으로 집계를 수행할 때 나타난다.
2. Sort Order By: 정렬된 결과집합을 얻고자 할 때 나타난다.
3. Sort Group By: Sorting 알고리즘을 사용해 그룹별 집계를 수행할 때 나타난다.
4. Sort Unique : 선택된 결과집합에서 중복 레코드를 제거하고자 할 때 나타난다. (Union, Distinct 등)
5. Sort Join: Sort Merge Join을 수행할 때 나타난다.
6. Window Sort: 윈도우 함수를 수행할 때 나타난다.

### 소트 튜닝 요약

- 소트 오퍼레이션은 메모리 집약적 & CPU 집약적이다.
- 부분범위처리를 할 수 없기 때문에 OLTP 환경에서 성능을 떨어뜨리는 주요 원인이 된다.

→ 될 수 있으면 소트를 사용하지 않고, 꼭 사용해야 한다면 메모리 내에서 수행할 수 있도록 해야 한다.

- 인덱스를 이용해서 소트 연산을 대체할 수 있는 방법이 있다.
- 소트 영역을 적게 사용하도록 SQL을 작성할 수 있다.
- 소트 영역의 크기를 지정할 수 있다.

## 2. 데이터 모델 측면에서의 검토

![](https://dataonair.or.kr/publishing/img/knowledge/etc_31.jpg)

![](https://dataonair.or.kr/publishing/img/knowledge/etc_32.jpg)

잘 정규화된 데이터 모델을 사용하지 않으면, group by, union, distinct 등의 절이 자주 사용됨으로써 성능이 저하되고, 쿼리 또한 복잡해지는 상황이 생길 수 있다.

















