# 공부한 내용

## 1. 파티션 개요

파티셔닝은 테이블 또는 인덱스 데이터를 파티션 단위로 나누어 저장하는 것을 뜻한다.

- 파티셔닝이 필요한 이유는 2가지로 나누어볼 수 있다.
  - 관리적 측면: 파티션 단위 백업, 추가, 삭제, 변경
  - 성능적 측면: 파티션 단위 조회 및 DML 수행, 경합 및 부하 분산

관리적 측면에서는, 파티션 단위의 백업, 추가, 삭제, 변경이 용이하다. 예를 들어 보관주기가 지난 데이터의 경우는 원래 별도의 보관장치에 백업하고 원래 자리에서 지우는 것이 일반적인데, 파티션 작업을 통해 손쉽게 처리활 수 있다.

성능적 측면에서는 당연히 좋다. 기본적으로 데이터에 엑세스할 때, Table Full Scan을 하냐 아니면 인덱스를 통해 스캔하냐 크게 2개의 방법이 있는데 사실 인덱스를 사용하더라도 Random 액세스 방식으로 인해 오히려 Table Full Scan보다 성능이 떨어지는 경우도 있다.

이런 경우 파티셔닝을 통해 애초에 스캔하는 데이터의 양을 줄임으로써 성능을 더 높일 수 있다.

## 2. 파티션 유형

### 2-1. Range 파티셔닝

파티션 키 값의 범위로 분할하는 방법이다. 기본적으로 파티셔닝에서 가장 많이 사용하는 방법이며, 주로 날짜 칼럼을 기준으로 분할한다.

### 2-2. Hash 파티셔닝

파티션 키 값에 해쉬 함수를 적용하고, 거기서 반환된 값으로 파티션을 매핑한다. 즉, 어떤 로우가 어디로 저장될지 전혀 예측할 수 없으며, 이로 인해 데이터가 모든 파티션에 고르게 분산된다.

파티션 키의 분포가 고른 칼럼을 기준으로 해야 효과적이다. 고객 번호, 일련 변호와 같이 중복이 사실상 없는 칼럼이어야 해쉬 함수를 적용했을 때 모두 다른 값이 나오기 때문이다.

병렬 처리 시에 성능효과가 극대화되며, DML 경합 분산에도 효과적이다.

### 2-3. List 파티셔닝

불연속적인 값의 목록을 각 파티션에 지정한다. 순서와 상관없이 사용자가 미리 정한 그룹핑 기준에 따라 분할하는 방법이다.

### 2-4. Composite 파티셔닝

Range, 또는 List 파티션 내에 또다른 서브 파티션을 둔다. (ex. Range, Hash, List)

각 파티셔닝의 이점을 고루 가질 수 있다.

### 예시

오라클에서 간단하게 Range 파티셔닝하는 방법을 알아보자.

![](https://dataonair.or.kr/publishing/img/knowledge/SQL_401.jpg)

```sql
create table 주문 ( 주문번호 number, 주문일자 varchar2(8), 고객id varchar2(5), ) 
partition by range(주문일자) ( 
	partition p2009_q1 values less than ('20090401') , 
	partition p2009_q2 values less than ('20090701') , 
	partition p2009_q3 values less than ('20091001') , 
	partition p2009_q4 values less than ('20100101') , 
	partition p2010_q1 values less than ('20100401') , 
	partition p9999_mx values less than ( MAXVALUE ) → 주문일자 >= '20100401' 
);
```










